<?xml version="1.0" encoding="utf-8"?>
<!-- Дополнительные шаги для сборки Android в версии UE 4.25 и выше / 
        Additional steps for building Android in UE version 4.25 and higher-->

<root xmlns:android="http://schemas.android.com/apk/res/android">
  <!-- Инициализация XML переменных / Initializing XML variables -->
  <init>    
    <setBool result="bSupported" value="false"/>

    <isArch arch="armeabi-v7a">
      <setBool result="bSupported" value="true"/>
    </isArch>

    <isArch arch="arm64-v8a">
      <setBool result="bSupported" value="true"/>
    </isArch>

    <if condition="bSupported">
      <false>
        <log text="WARNING: this architecture is not supported for libelias.so!"/>
      </false>      
    </if>
    
  </init>

  <!-- Данные файлы копируются во время сборки в компановшик, dst должен совпадать с package в (*.java) / 
          These files are copied during build to the linker, and the dst must match package in (*. java) -->
  <prebuildCopies>
    <copyDir src="$S(PluginDir)/../../Private/Android/Java" dst="$S(BuildDir)/src/com/epicgames/ue4" />
  </prebuildCopies>

  <!-- Объявить собственные классы / Declare your own classes -->
  <proguardAdditions>
    <insert>
      -keep public class com.epicgames.ue4.** { public protected *; }
    </insert>
  </proguardAdditions>

  <!-- Данные бибилотеки копируются во время сборки в компановшик / 
        Library data is copied to the linker during build -->
  <resourceCopies>

    <isArch arch="armeabi-v7a">

      <!--<copyFile src="$S(PluginDir)/armeabi-v7a/lib/libExample.so"
    dst="$S(BuildDir)/libs/armeabi-v7a/libexample.so" /> -->
      
    </isArch>

    <isArch arch="arm64-v8a">

      <!--<copyFile src="$S(PluginDir)/arm64-v8a/lib/libExample.so"
          dst="$S(BuildDir)/libs/arm64-v8a/libexample.so" />-->

    </isArch>

  </resourceCopies>

  <!-- Подключить библиотеки в самом приложении (Иногда это не нужно) / 
        Enable libraries in the app itself (Sometimes you don't need to) -->
  <soLoadLibrary>
    <!--<loadLibrary name="example" failmsg="XML! library not loaded and required!" />-->
  </soLoadLibrary>

  <!-- Объявить класcы для Android / Declare classes for Android -->
  <proguardAdditions>
    <insert>
      -keep public class android.support.v4.app.** { public protected *; }
      -keep public interface android.support.v4.app.** { public protected *; }
      -keep public class android.support.v7.** { public protected *; }
      -keep public interface android.support.v7.** { public protected *; }
    </insert>
  </proguardAdditions>

  <!-- Добавить строки в систему сборки gradle / Add strings to the gradle build system -->
  <buildGradleAdditions>
    <insert>
      dependencies {
        implementation 'com.android.support:exifinterface:28.0.0'
        implementation 'com.android.support:support-v4:28.0.0'
        implementation 'com.android.support:appcompat-v7:28.0.0'
      }
      repositories {
        maven {
          url 'https://maven.google.com'
        }
      }
    </insert>
  </buildGradleAdditions>
  
</root>